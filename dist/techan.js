!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],t):t((n=n||self).techan={},n.d3)}(this,function(n,t){"use strict";const e=function(){var n=function(n){return n.date},t=function(n){return n.up},e=function(n){return n.down};function r(n){return r.up(n)}function a(){return r.d=n,r.up=t,r.dn=e,r}return r.date=function(t){return arguments.length?(n=t,a()):n},r.up=function(n){return arguments.length?(t=n,a()):t},r.down=function(n){return arguments.length?(e=n,a()):e},a()},r=function(){var n=function(n,t){return arguments.length<2?n.x:(n.x=t,e)},t=function(n,t){return arguments.length<2?n.y:(n.y=t,e)};function e(n){return e.xv(n)}function r(){return e.xv=n,e.yv=t,e}return e.x=function(t){return arguments.length?(n=t,r()):n},e.y=function(n){return arguments.length?(t=n,r()):t},r()},a=function(){var n=function(n){return n.date},t=function(n){return n.tenkanSen},e=function(n){return n.kijunSen},r=function(n){return n.senkouSpanA},a=function(n){return n.senkouSpanB},c=function(n){return n.chikouSpan},o=function(n){return n.parameters.tenkanSen},u=function(n){return n.parameters.kijunSen},i=function(n){return n.parameters.senkouSpanB};function s(n){return s.ts(n)}function l(){return s.d=n,s.ts=t,s.ks=e,s.sa=r,s.sb=a,s.c=c,s.pts=o,s.pks=u,s.pssb=i,s}return s.date=function(t){return arguments.length?(n=t,l()):n},s.tenkanSen=function(n){return arguments.length?(t=n,l()):t},s.kijunSen=function(n){return arguments.length?(e=n,l()):e},s.senkouSpanA=function(n){return arguments.length?(r=n,l()):r},s.senkouSpanB=function(n){return arguments.length?(a=n,l()):a},s.chikouSpan=function(n){return arguments.length?(c=n,l()):c},s.ptenanSen=function(n){return arguments.length?(o=n,l()):o},s.pkijunSen=function(n){return arguments.length?(u=n,l()):u},s.psenkouSpanB=function(n){return arguments.length?(i=n,l()):i},l()},c=function(){var n=function(n){return n.date},t=function(n){return n.macd},e=function(n){return n.zero},r=function(n){return n.signal},a=function(n){return n.difference};function c(n){return c.m(n)}function o(){return c.d=n,c.m=t,c.s=r,c.dif=a,c.z=e,c}return c.date=function(t){return arguments.length?(n=t,o()):n},c.macd=function(n){return arguments.length?(t=n,o()):t},c.signal=function(n){return arguments.length?(r=n,o()):r},c.difference=function(n){return arguments.length?(a=n,o()):a},o()},o=function(){var n=function(n){return n.date},t=function(n){return n.open},e=function(n){return n.high},r=function(n){return n.low},a=function(n){return n.close},c=function(n){return n.volume};function o(n){return o.c(n)}function u(){return o.d=n,o.o=t,o.h=e,o.l=r,o.c=a,o.v=c,o}return o.date=function(t){return arguments.length?(n=t,u()):n},o.open=function(n){return arguments.length?(t=n,u()):t},o.high=function(n){return arguments.length?(e=n,u()):e},o.low=function(n){return arguments.length?(r=n,u()):r},o.close=function(n){return arguments.length?(a=n,u()):a},o.volume=function(n){return arguments.length?(c=n,u()):c},u()},u=function(){var n=function(n){return n.date},t=function(n){return n.rsi},e=function(n){return n.overbought},r=function(n){return n.oversold},a=function(n){return n.middle};function c(n){return c.r(n)}function o(){return c.d=n,c.r=t,c.ob=e,c.os=r,c.m=a,c}return c.date=function(t){return arguments.length?(n=t,o()):n},c.rsi=function(n){return arguments.length?(t=n,o()):t},c.overbought=function(n){return arguments.length?(e=n,o()):e},c.oversold=function(n){return arguments.length?(r=n,o()):r},c.middle=function(n){return arguments.length?(a=n,o()):a},o()},i=function(){var n=function(n,t){if(arguments.length<2)return n.start.date;n.start.date=t},t=function(n,t){if(arguments.length<2)return n.start.value;n.start.value=t},e=function(n,t){if(arguments.length<2)return n.end.date;n.end.date=t},r=function(n,t){if(arguments.length<2)return n.end.value;n.end.value=t};function a(n){return a.sv(n)}function c(){return a.sd=n,a.sv=t,a.ed=e,a.ev=r,a}return a.startDate=function(t){return arguments.length?(n=t,c()):n},a.startValue=function(n){return arguments.length?(t=n,c()):t},a.endDate=function(n){return arguments.length?(e=n,c()):e},a.endValue=function(n){return arguments.length?(r=n,c()):r},c()},s=function(){var n=function(n){return n.date},t=function(n,t){return arguments.length<2?n.value:(n.value=t,r)},e=function(n){return 0};function r(n){return r.v(n)}function a(){return r.d=n,r.v=t,r.z=e,r}return r.date=function(t){return arguments.length?(n=t,a()):n},r.value=function(n){return arguments.length?(t=n,a()):t},r.zero=function(n){return arguments.length?(e=n,a()):e},a()},l=function(){var n=function(n){return n.date},t=function(n){return n.volume};function e(n){return e.v(n)}function r(){return e.d=n,e.v=t,e}return e.date=function(t){return arguments.length?(n=t,r()):n},e.volume=function(n){return arguments.length?(t=n,r()):t},r()},d=function(){var n=function(n){return n.date},t=function(n){return n.high},e=function(n){return n.low},r=function(n){return n.spread};function a(n){c()}function c(){return a.d=n,a.h=t,a.l=e,a.s=r,a}return a.date=function(t){return arguments.length?(n=t,c()):n},a.high=function(n){return arguments.length?(t=n,c()):t},a.low=function(n){return arguments.length?(e=n,c()):e},a.spread=function(n){return arguments.length?(r=n,c()):r},c()},f=function(){var n=function(n){return n.date},t=function(n){return n.type},e=function(n){return n.price};function r(n){return r.p(n)}function a(){return r.d=n,r.t=t,r.p=e,r}return r.date=function(t){return arguments.length?(n=t,a()):n},r.type=function(n){return arguments.length?(t=n,a()):t},r.price=function(n){return arguments.length?(e=n,a()):e},a()},p=function(){var n=function(n){return n.date},t=function(n){return n.adx},e=function(n){return n.plusDi},r=function(n){return n.minusDi};function a(n){return a.r(n)}function c(){return a.d=n,a.adx=t,a.plusDi=e,a.minusDi=r,a}return a.date=function(t){return arguments.length?(n=t,c()):n},a.adx=function(n){return arguments.length?(t=n,c()):t},a.plusDi=function(n){return arguments.length?(e=n,c()):e},a.minusDi=function(n){return arguments.length?(r=n,c()):r},c()},h=function(){var n=function(n){return n.date},t=function(n){return n.up},e=function(n){return n.down},r=function(n){return n.oscillator},a=function(n){return n.overbought},c=function(n){return n.oversold},o=function(n){return n.middle};function u(n){return u.r(n)}function i(){return u.d=n,u.up=t,u.down=e,u.oscillator=r,u.ob=a,u.os=c,u.m=o,u}return u.date=function(t){return arguments.length?(n=t,i()):n},u.up=function(n){return arguments.length?(t=n,i()):t},u.down=function(n){return arguments.length?(e=n,i()):e},u.oscillator=function(n){return arguments.length?(r=n,i()):r},u.overbought=function(n){return arguments.length?(a=n,i()):a},u.oversold=function(n){return arguments.length?(c=n,i()):c},u.middle=function(n){return arguments.length?(o=n,i()):o},i()},v=function(){var n=function(n){return n.date},t=function(n){return n.stochasticK},e=function(n){return n.stochasticD},r=function(n){return n.overbought},a=function(n){return n.oversold};function c(n){return c.r(n)}function o(){return c.d=n,c.k=t,c.sd=e,c.ob=r,c.os=a,c}return c.date=function(t){return arguments.length?(n=t,o()):n},c.stochasticK=function(n){return arguments.length?(t=n,o()):t},c.stochasticD=function(n){return arguments.length?(e=n,o()):e},c.overbought=function(n){return arguments.length?(r=n,o()):r},c.oversold=function(n){return arguments.length?(a=n,o()):a},o()},m=function(){var n=function(n){return n.start},t=function(n){return n.end},e=function(n,t){return arguments.length<2?n.value:(n.value=t,r)};function r(n){return r.v(n)}function a(){return r.s=n,r.e=t,r.v=e,r}return r.start=function(t){return arguments.length?(n=t,a()):n},r.end=function(n){return arguments.length?(t=n,a()):t},r.value=function(n){return arguments.length?(e=n,a()):e},a()},g=function(){var n=function(n){return n.date},t=function(n){return n.williams};function e(n){return e.r(n)}function r(){return e.d=n,e.w=t,e}return e.date=function(t){return arguments.length?(n=t,r()):n},e.williams=function(n){return arguments.length?(t=n,r()):t},r()},S=function(){var n=function(n){return n.date},t=function(n){return n.middleBand},e=function(n){return n.upperBand},r=function(n){return n.lowerBand};function a(n){return a.r(n)}function c(){return a.d=n,a.middle=t,a.upper=e,a.lower=r,a}return a.date=function(t){return arguments.length?(n=t,c()):n},a.middle=function(n){return arguments.length?(t=n,c()):t},a.upper=function(n){return arguments.length?(e=n,c()):e},a.lower=function(n){return arguments.length?(r=n,c()):r},c()},y=()=>({atrtrailingstop:e,crosshair:r,ichimoku:a,macd:c,ohlc:o,rsi:u,trendline:i,value:s,volume:l,tick:d,trade:f,adx:p,aroon:h,stochastic:v,supstance:m,williams:g,bollinger:S}),x=function(n,t,e){return function(){var r,a,c,o,u={};function i(n){return i.init(),n.map(s).filter(function(n){return null!==n.value})}function s(n,t){var e=i.average(u.accessor(n));return t+1<u.period&&(e=null),{date:u.accessor.d(n),value:e}}return i.init=function(){return r=null,a=e(u.period),c=0,o=0,i},i.average=function(n){return o<u.period?r=(c+=n)/++o:r+=a*(n-r)},n(i,u).accessor(t()).period(10),i}};function k(n,t){return t?{date:n,value:t}:{date:n,value:null}}function w(n){var t=[],e=n-1;return w.push=function(r){e=++e%n,t.length<n?t.push(r):t[e]=r},w.get=function(n){return t[(e+t.length-n)%t.length]},w.head=function(){return w.get(0)},w.last=function(){return w.get(t.length-1)},w.size=function(){return n},w.samples=function(){return t},w.primed=function(){return t.length===n},w}const M=function(){return{circularbuffer:w,rebindCallback:b,rebind:function(n,t){var e=Array.prototype.slice.call(arguments,0);return e.splice(2,0,void 0),b.apply(this,e)},functor:function(n){return"function"==typeof n?n:function(){return n}}}};function b(n,t,e){for(var r,a=2,c=arguments.length;++a<c;)n[r=arguments[a]]=L(n,t,t[r],e);return n}function L(n,t,e,r){return function(){var a=e.apply(t,arguments);return r&&a===t&&r(),a===t?n:a}}const D=function(n,t,e,r,a){return function(){var c,o={},u=r().period(a);function i(n){return i.init(),n.map(s).filter(function(n){return null!==n.value})}function s(n,t){var e=i.roc(o.accessor(n));return(!c.primed()||t+1<u.period())&&(e=null),{date:o.accessor.d(n),value:e}}return i.init=function(){return u.init(),c=n(o.period),i},i.roc=function(n){return c.push(u.average(n)),(c.head()-c.last())/c.last()},i.ema=function(n){return arguments.length?(u=n,i):u},t(i,o).accessor(e()).period(21),i}},z=function(n,t){return function(){var e,r,a,c={};function o(n){return o.init(),n.map(u).filter(function(n){return null!==n.value})}function u(n,t){t>0&&a.getDate()!=c.accessor.d(n).getDate()&&(e=0,r=0);var o=(c.accessor.h(n)+c.accessor.l(n)+c.accessor.c(n))/3;return e+=o*c.accessor.v(n),r+=c.accessor.v(n),a=c.accessor.d(n),{date:c.accessor.d(n),value:e/r}}return o.init=function(){return e=0,r=0,o},n(o,c).accessor(t()).period(1),o}},A=function(n,t,e){return function(){var r={},a=3,c=e();function o(n){return c.accessor(r.accessor).period(r.period).init(),n.map(function(n,t){var e=r.accessor.c(n),o=c.atr(n)*a;return t>=r.period?{date:r.accessor.d(n),close:e,up:e-o,down:e+o}:{date:r.accessor.d(n),up:null,down:null}}).filter(function(n){return null!==n.up&&null!==n.down}).reduce(function(n,t,e){var r=n[e-1],a=0===e?t.up:null,c=null;return r&&null!==r.up&&(t.close>r.up?a=Math.max(t.up,r.up):c=t.down),r&&null!==r.down&&(t.close<r.down?c=Math.min(t.down,r.down):a=t.up),n.push({date:t.date,up:a,down:c}),n},[])}return o.multiplier=function(n){return arguments.length?(a=n,o):a},n(o,r).accessor(t()).period(14),o}},P=function(n,t,e,r){return function(){var a={};function c(n){var t;return n.map(function(n){var c={date:a.accessor.d(n),open:(void 0===t?a.accessor.o(n)+a.accessor.c(n):t.open+t.close)/2,close:(a.accessor.o(n)+a.accessor.h(n)+a.accessor.l(n)+a.accessor.c(n))/4};return c.high=r([c.open,c.close,a.accessor.h(n)]),c.low=e([c.open,c.close,a.accessor.l(n)]),void 0!==a.accessor.v&&void 0!==a.accessor.v(n)&&(c.volume=a.accessor.v(n)),t=c})}return n(c,a).accessor(t()),c}},j=function(n,t){return function(){var e={},r=9,a=26,c=52;function o(n){for(var t={tenkanSen:r,kijunSen:a,senkouSpanB:c},e=new Array(n.length),o=e.length-1;o>=0;o--)e[o]=u(t,n,o);return e}function u(n,t,r){for(var a=t[r],c=e.accessor.l(a),o=e.accessor.h(a),u=function(n,t,e){return{parameters:n,date:t,chikouSpan:e,tenkanSen:null,kijunSen:null,senkouSpanA:null,senkouSpanB:null}}(n,e.accessor.d(a),e.accessor.c(a)),i=0,s=i+1;i<n.senkouSpanB&&r-i>=0;s=++i+1)a=t[r-i],c=Math.min(c,e.accessor.l(a)),o=Math.max(o,e.accessor.h(a)),u.tenkanSen=s===n.tenkanSen?F(c,o):u.tenkanSen,u.kijunSen=s===n.kijunSen?F(c,o):u.kijunSen,u.senkouSpanB=s===n.senkouSpanB?F(c,o):u.senkouSpanB;return u.senkouSpanA=function(n,t){return null!==n&&null!==t?F(n,t):null}(u.tenkanSen,u.kijunSen),u}return o.tenkanSen=function(n){return arguments.length?(r=n,o):r},o.kijunSen=function(n){return arguments.length?(a=n,o):a},o.senkouSpanB=function(n){return arguments.length?(c=n,o):c},n(o,e).accessor(t()),o}};function F(n,t){return(n+t)/2}const B=function(n,t,e){return function(){var r={},a=12,c=26,o=9,u=e(),i=e(),s=e();function l(n){var t=Math.max(a,c)-1,e=t+o-1;return u.accessor(l.accessor()).period(o).init(),i.accessor(l.accessor()).period(a).init(),s.accessor(l.accessor()).period(c).init(),n.map(function(n,a){var c=i.average(r.accessor(n))-s.average(r.accessor(n)),o=a>=t?u.average(c):null;return a>=e?N(r.accessor.d(n),c,o,c-o,0):N(r.accessor.d(n))}).filter(function(n){return null!==n.macd})}return l.fast=function(n){return arguments.length?(a=n,l):a},l.slow=function(n){return arguments.length?(c=n,l):c},l.signal=function(n){return arguments.length?(o=n,l):o},n(l,r).accessor(t()).preroll(l.slow),l}};function N(n,t,e,r,a){return t?{date:n,macd:t,signal:e,difference:r,zero:a}:{date:n,macd:null,signal:null,difference:null,zero:null}}const I=function(n,t,e){return function(){var r={},a=70,c=50,o=30,u=e(),i=e();function s(n){return u.accessor(s.accessor()).period(r.period).init(),i.accessor(s.accessor()).period(r.period).init(),n.map(function(t,e){if(e<1)return U(r.accessor.d(t));var s=r.accessor(t)-r.accessor(n[e-1]),l=i.average(Math.max(s,0)),d=Math.abs(u.average(Math.min(s,0)));if(e>=r.period){var f=100-100/(1+l/d);return U(r.accessor.d(t),f,c,a,o)}return U(r.accessor.d(t))}).filter(function(n){return null!==n.rsi})}return s.overbought=function(n){return arguments.length?(a=n,s):a},s.middle=function(n){return arguments.length?(c=n,s):c},s.oversold=function(n){return arguments.length?(o=n,s):o},n(s,r).accessor(t()).period(14),s}};function U(n,t,e,r,a){return t?{date:n,rsi:t,middle:e,overbought:r,oversold:a}:{date:n,rsi:null,middle:null,overbought:null,oversold:null}}const _=function(n,t,e,r){return function(){var a={};function c(t){var e=r().accessor(c.accessor()).period(a.period).init(),o=r().accessor(c.accessor()).period(a.period).init(),u=r().accessor(c.accessor()).period(a.period).init(),i=r().accessor(c.accessor()).period(a.period).init();return t.map(function(r,c){if(c<1)return C(a.accessor.d(r));var s=a.accessor.h(t[c])-a.accessor.h(t[c-1]),l=a.accessor.l(t[c-1])-a.accessor.l(t[c]),d=0;s>l&&s>0&&(d=s);var f=0;l>s&&l>0&&(f=l);var p=n([a.accessor.h(r)-a.accessor.l(r),Math.abs(a.accessor.h(r)-a.accessor.c(t[c-1])),Math.abs(a.accessor.l(r)-a.accessor.c(t[c-1]))]),h=e.average(d),v=o.average(f),m=u.average(p);if(c>a.period){var g=100*h/m,S=100*v/m,y=0;g-S!=0&&(y=Math.abs((g-S)/(g+S)));var x=100*i.average(y);return c>=2*a.period?C(a.accessor.d(r),x,g,S):C(a.accessor.d(r))}return C(a.accessor.d(r))}).filter(function(n){return n.adx})}return t(c,a).accessor(e()).period(14),c}};function C(n,t,e,r){return e?{date:n,adx:t,plusDi:e,minusDi:r}:{date:n,adx:null,plusDi:null,minusDi:null}}const E=function(n,t){return function(){var e={},r=70,a=0,c=30;function o(n){return n.map(function(t,o){if(o>=e.period-1){for(var u=0,i=0,s=1e4,l=0,d=0;d<e.period;d++)e.accessor.h(n[o-d])>u&&(u=e.accessor.h(n[o-d]),i=d),e.accessor.l(n[o-d])<s&&(s=e.accessor.l(n[o-d]),l=d);var f=(e.period-i)/e.period*100,p=(e.period-l)/e.period*100,h=f-p;return T(e.accessor.d(t),f,p,h,a,r,c)}return T(e.accessor.d(t))}).filter(function(n){return n.up})}return o.overbought=function(n){return arguments.length?(r=n,o):r},o.middle=function(n){return arguments.length?(a=n,o):a},o.oversold=function(n){return arguments.length?(c=n,o):c},n(o,e).accessor(t()).period(20),o}};function T(n,t,e,r,a,c,o){return t?{date:n,up:t,down:e,oscillator:r,middle:a,overbought:c,oversold:o}:{date:n,up:null,down:null,oscillator:null,middle:null,overbought:null,oversold:null}}const H=function(n,t){return function(){var e={},r=3,a=80,c=20;function o(n){var t=o.preroll();return n.map(function(o,u){if(u>=t){for(var i=[],s=[],l=[],d=0;d<r;d++)i.push(0),s.push(1e4),l.push(0);for(var f=0,p=0;p<r;p++){for(var h=0;h<e.period;h++)e.accessor.h(n[u-h-p])>i[p]&&(i[p]=e.accessor.h(n[u-h-p])),e.accessor.l(n[u-h-p])<s[p]&&(s[p]=e.accessor.l(n[u-h-p]));var v=i[p]-s[p];l[p]=v>0?(e.accessor.c(n[u-p])-s[p])/(i[p]-s[p])*100:50,f+=l[p]}var m=l[0];return f/=r,q(e.accessor.d(o),m,f,a,c)}return q(e.accessor.d(o),null,null,a,c)}).filter(function(n){return n.stochasticK})}return o.periodD=function(n){return arguments.length?(r=+n,o):r},o.overbought=function(n){return arguments.length?(a=n,o):a},o.oversold=function(n){return arguments.length?(c=n,o):c},n(o,e).accessor(t()).period(20).preroll(function(){return e.period+r}),o}};function q(n,t,e,r,a){return t?{date:n,stochasticK:t,stochasticD:e,overbought:r,oversold:a}:{date:n,stochasticK:null,stochasticD:null,overbought:r,oversold:a}}const W=function(n,t){var e={},r=80,a=50,c=20;function o(n){return n.map(function(t,o){if(o>=e.period){for(var u=0,i=1e4,s=0;s<e.period;s++)e.accessor.h(n[o-s])>u&&(u=e.accessor.h(n[o-s])),e.accessor.l(n[o-s])<i&&(i=e.accessor.l(n[o-s]));var l=(e.accessor.c(n[o])-i)/(u-i)*100;return Y(e.accessor.d(t),l,a,r,c)}return Y(e.accessor.d(t))}).filter(function(n){return n.williams})}return o.overbought=function(n){return arguments.length?(r=n,o):r},o.middle=function(n){return arguments.length?(a=n,o):a},o.oversold=function(n){return arguments.length?(c=n,o):c},n(o,e).accessor(t()).period(20),o};function Y(n,t,e,r,a){return t?{date:n,williams:t,middle:e,overbought:r,oversold:a}:{date:n,williams:null,middle:null,overbought:null,oversold:null}}const K=function(n,t,e){return function(){var r,a={},c=2;function o(n){var t,u=e().accessor(o.accessor()).period(a.period).init();return n.map(function(e,o){var i=u.average(a.accessor(e));if(o>=a.period){var s=0;for(t=0;t<a.period;t++)s+=Math.pow(a.accessor.c(n[o-t])-i,2);r=Math.sqrt(s/a.period);var l=i+c*r,d=i-c*r;return O(a.accessor.d(e),i,l,d)}return O(a.accessor.d(e))}).filter(function(n){return n.middleBand})}return o.sdMultiplication=function(n){return arguments.length?(c=n,o):c},n(o,a).accessor(t()).period(20),o}};function O(n,t,e,r){return t?{date:n,middleBand:t,upperBand:e,lowerBand:r}:{date:n,middleBand:null,upperBand:null,lowerBand:null}}function G(n){return 2/(n+1)}function R(n){return 1/n}const V=function(n){return{arrow:(t=M().functor,function(){var n=t(0),e=t(0),r=t(12),a=t(15),c=t("up"),o=t(!0);function u(t,u){var i,s=n(t,u),l=e(t,u),d=r(t,u),f=a(t,u),p=c(t,u),h=o(t,u),v="left"===p||"up"===p?1:-1,m=d/3,g=d/2,S=h?f/2:f;switch(i="M "+s+" "+l,p){case"up":case"down":i+=" l "+-g+" "+v*S+" l "+m+" 0",h&&(i+=" l 0 "+v*S),i+=" l "+m+" 0",h&&(i+=" l 0 "+-v*S),i+=" l "+m+" 0";break;case"left":case"right":i+=" l "+v*S+" "+-g+" l 0 "+m,h&&(i+=" l "+v*S+" 0"),i+=" l 0 "+m,h&&(i+=" l "+-v*S+" 0"),i+=" l 0 "+m;break;default:throw"Unsupported arrow.orient() = "+c}return i+" z"}return u.x=function(e){return arguments.length?(n=t(e),u):n},u.y=function(n){return arguments.length?(e=t(n),u):e},u.height=function(n){return arguments.length?(a=t(n),u):a},u.width=function(n){return arguments.length?(r=t(n),u):r},u.orient=function(n){return arguments.length?(c=t(n),u):c},u.tail=function(n){return arguments.length?(o=t(n),u):o},u})()};var t},X=function(n,t,e,r,a,c){function o(t,f,p,h,v,m,g,S,y){var x,k={tickFormat:t.daily[t.daily.length-1][2]},w=3;function M(n,t){var r=x[n instanceof Date?n.getTime():+n];return t=t||0,void 0===r&&(r=h[0]>n?-1:e(h,n)),p(r+t)}function b(){return w=function(n,t,e){return Math.abs(n(t.length-1)-n(0))/Math.max(1,t.length-1)*(1-e)}(p,h,v),M}function L(){x=u(h)}function D(){return L(),p.domain([0,h.length-1]),b(),p.domain(p.range().map(a(m,w)).map(p.invert)),g.domain=p.domain(),b()}function z(n,r,a){if(1==n.length)return f;var c=n[n.length-1]-n[0],o=c/s<1,u=o?t.intraday:t.daily,i=o?d:l,p=c/Math.min(Math.round(function(n,t){return n.length/(t[t.length-1]-t[0])}(n,r)*a),a),h=e(i,p);return h==u.length?u[h-1]:h?u[p/i[h-1]<i[h]/p?h-1:h]:u[h]}return p=p||n(),h=h||[new Date(0),new Date(1)],v=void 0===v?.2:v,m=void 0===m?.65:m,g=g||{domain:p.domain()},S=S||!1,y=y||c(p,b,g),M.invert=function(n){var t=h[M.invertToIndex(n)];return t||null},M.invertToIndex=function(n){return Math.round(p.invert(n))},M.domain=function(n){if(!arguments.length){var t=p.domain();return t[0]<0&&t[t.length-1]<0?[]:(t=[Math.max(Math.ceil(t[0]),0),Math.min(Math.floor(t[t.length-1]),h.length-1)],h.slice(t[0],t[t.length-1]+1))}return h=n,D()},M.copy=function(){return o(t,f,p.copy(),h,v,m,g,S)},M.band=function(){return w},M.outerPadding=function(n){return arguments.length?(m=n,D()):m},M.padding=function(n){return arguments.length?(v=n,D()):v},M.zoomable=function(){return y},M.ticks=function(n,t){var r=M.domain(),a=p.domain();if(!r.length)return[];var c=void 0===n?z(r,a,10):"number"==typeof n?z(r,a,n):null;return k.tickFormat=c?c[2]:z(r,a,10)[2],c&&(n=c[0],t=c[1]),n.every(t).range(r[0],+r[r.length-1]+1).map(function(n,t){var r=u(n);return function(a){var c=r[+a];if(void 0!==c)return n[c];var o=e(n,a);return t&&o>0&&+a-+n[o-1]<+n[o]-+a&&o--,n[o]}}(r,S)).reduce(i,[])},M.closestTicks=function(n){return arguments.length?(S=n,M):S},M.tickFormat=function(){return function(n){return k.tickFormat(n)}},r(M,p,b,"range"),L(),b()}function u(n){var t={};return n.forEach(function(n,e){t[+n]=e}),t}function i(n,t){return 0!==n.length&&n[n.length-1]===t||n.push(t),n}var s=864e5,l=[s,6048e5,2592e6,7776e6,31536e6],d=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5],f=t.timeFormat("%b %e"),p=J([[t.timeFormat("%b %Y"),function(n){return n.getMonth()}],[t.timeFormat("%Y"),function(){return!0}]]),h=J([[t.timeFormat(":%S"),function(n){return n.getSeconds()}],[t.timeFormat("%I:%M"),function(n){return n.getMinutes()}],[t.timeFormat("%I %p"),function(){return!0}]]),v=[t.timeSecond,1,J([[t.timeFormat(":%S"),function(n){return n.getSeconds()}],[t.timeFormat("%I:%M"),function(n){return n.getMinutes()}],[t.timeFormat("%I %p"),function(n){return n.getHours()}],[t.timeFormat("%b %e"),function(){return!0}]])],m=t.utcFormat("%b %e"),g=J([[t.utcFormat("%b %Y"),function(n){return n.getUTCMonth()}],[t.utcFormat("%Y"),function(){return!0}]]),S=J([[t.utcFormat(":%S"),function(n){return n.getUTCSeconds()}],[t.utcFormat("%I:%M"),function(n){return n.getUTCMinutes()}],[t.utcFormat("%I %p"),function(){return!0}]]),y=[t.timeSecond,1,J([[t.utcFormat(":%S"),function(n){return n.getUTCSeconds()}],[t.utcFormat("%I:%M"),function(n){return n.getUTCMinutes()}],[t.utcFormat("%I %p"),function(n){return n.getUTCHours()}],[t.utcFormat("%b %e"),function(){return!0}]])],x=[[t.timeDay,1,f],[t.timeMonday,1,f],[t.timeMonth,1,p],[t.timeMonth,3,p],[t.timeYear,1,p]],k=[[t.timeSecond,1,h],[t.timeSecond,5,h],[t.timeSecond,15,h],[t.timeSecond,30,h],[t.timeMinute,1,h],[t.timeMinute,5,h],[t.timeMinute,15,h],[t.timeMinute,30,h],[t.timeHour,1,h],[t.timeHour,3,h],[t.timeHour,6,h],[t.timeHour,12,h],[t.timeDay,1,f]],w=[[t.utcDay,1,m],[t.utcMonday,1,m],[t.utcMonth,1,g],[t.utcMonth,3,g],[t.utcYear,1,g]],M=[[t.utcSecond,1,S],[t.utcSecond,5,S],[t.utcSecond,15,S],[t.utcSecond,30,S],[t.utcMinute,1,S],[t.utcMinute,5,S],[t.utcMinute,15,S],[t.utcMinute,30,S],[t.utcHour,1,S],[t.utcHour,3,S],[t.utcHour,6,S],[t.utcHour,12,S],[t.utcDay,1,m]];function b(){return o({daily:x,intraday:k},v)}return b.utc=function(){return o({daily:w,intraday:M},y)},b};function J(n){return function(t){for(var e=0;e<n.length;e++)if(n[e][1](t))return n[e][0](t)}}const Q=function(n){var t=function n(t,e,r,a){function c(n){return t.apply(t,arguments)}return a=void 0===a||a,c.invert=t.invert,c.domain=function(n){return arguments.length?(a?t.domain([Math.max(r.domain[0],n[0]),Math.min(r.domain[1],n[1])]):t.domain(n),e&&e(),c):t.domain()},c.range=function(n){if(!arguments.length)return t.range();throw"zoomable is a read only range. Use this scale for zooming only"},c.copy=function(){return n(t.copy(),e,r,a)},c.clamp=function(n){return arguments.length?(a=n,c):a},c},e=M(),r=y(),a=X(n.scaleLinear,n,n.bisect,e.rebindCallback,$,t);function c(t,e){return e=e||r.ohlc(),n.scaleLinear().domain([n.min(t.map(e.low())),n.max(t.map(e.high()))].map($(.02)))}function o(t,e,a){return e=e||r.value(),Z(n,t,e,a=void 0===a?.02:a)}return{financetime:a,plot:{adx:function(){return n.scaleLinear().domain([0,100])},aroon:function(){return n.scaleLinear().domain([-100,100])},atr:o,atrtrailingstop:function(t,e){e=e||r.atrtrailingstop();var a=nn(t,function(n){return[e.up(n),e.dn(n)]});return n.scaleLinear().domain(n.extent(a).map($(.04)))},bollinger:function(t,e){return e=e||r.bollinger(),n.scaleLinear().domain([n.min(t.map(function(n){return e.lower(n)})),n.max(t.map(function(n){return e.upper(n)}))].map($(.02)))},candlestick:c,close:o,ema:o,heikinashi:c,ichimoku:function(t,e){e=e||r.ichimoku();var a=nn(t,function(n,r){var a=t[r+e.pks(n)],c=t[r-e.pks(n)];return[e.ts(n),e.ks(n),c?e.sa(c):null,c?e.sb(c):null,a?e.c(a):null]});return n.scaleLinear().domain(n.extent(a).map($(.02)))},macd:function(t,e){return e=e||r.macd(),Z(n,t,e,.02)},momentum:o,moneyflow:o,ohlc:c,percent:function(n,t){var e=n.domain();return t=t||e[0],n.copy().domain([e[0],e[e.length-1]].map(function(n){return(n-t)/t}))},roc:o,rsi:function(){return n.scaleLinear().domain([0,100])},sma:o,sroc:o,stochastic:function(){return n.scaleLinear().domain([0,100])},supstance:function(t,e){return e=e||r.supstance(),Z(n,t,e.v,.02)},tick:c,time:function(n,t){return t=t||r.value(),a().domain(n.map(t.d))},tradearrow:function(t,e){return e=e||r.trade(),Z(n,t,e.p,.02)},trendline:function(t,e){e=e||r.trendline();var a=nn(t,function(n){return[e.sv(n),e.ev(n)]});return n.scaleLinear().domain(n.extent(a).map($(.04)))},volume:function(t,e){return e=e||r.ohlc().v,n.scaleLinear().domain([0,1.15*n.max(t.map(e))])},vwap:o,wilderma:o,williams:function(){return n.scaleLinear().domain([0,100])}}}};function Z(n,t,e,r){return n.scaleLinear().domain(function(n,t,e,r){return t.length>0?n.extent(t,e).map($(r)):[]}(n,t,e,r))}function $(n,t){return n=n||0,function(e,r,a){if(a.length>2)throw"array.length > 2 unsupported. array.length = "+a.length;return e+(2*r-1)*(t=t||a[a.length-1]-a[0])*n}}function nn(n,t){return n.map(t).reduce(function(n,t){return n.concat(t)}).filter(function(n){return null!==n})}const tn=function(n,t,e,r){var a=function(n){var t,e,r=["data"];function a(e){var c=a.select(e).data(n,t),o=c.enter().append("g").attr("class",i(r," "));return c.exit().remove(),{entry:o,selection:o.merge(c)}}return a.select=function(n){return n.selectAll("g."+i(r,"."))},a.mapper=function(t){return arguments.length?(n=t,a):n},a.scope=function(n){return arguments.length?(r=["data","scope-"+(e=n)],a):e},a.key=function(n){return arguments.length?(t=n,a):t},a};function c(n){return{up:function(t){return n.o(t)<n.c(t)},down:function(t){return n.o(t)>n.c(t)},equal:function(t){return n.o(t)===n.c(t)}}}function o(n,t,e,r){var a=e instanceof Array?e:[e];r=r||c(t),Object.keys(r).forEach(function(t){!function(n,t,e,r){n.selectAll("path."+i(e,".")+"."+r).data(function(n){return[n.filter(t)]}).enter().append("path").attr("class",i(e," ")+" "+r)}(n,r[t],a,t)})}function u(n){return void 0!==n.band?Math.max(n.band(),1):3}function i(n,t){if(n.length){for(var e=n[0],r=1;r<n.length;r++)e+=t+n[r];return e}}return a.mapper={unity:function(n){return n},array:function(n){return[n]}},{dataSelector:a,appendPathsGroupBy:o,appendPathsUpDownEqual:function(n,t,e){o(n,t,e,c(t))},horizontalPathLine:function(n,t,e,r){return function(a){if(!a.length)return null;var c=a[0],o=a[a.length-1];return"M "+t(n(c))+" "+r(e(c))+" L "+t(n(o))+" "+r(e(o))}},pathLine:function(){var t=n().curve(e);function r(n){return t(n)}return r.init=function(n,e,r,a,c){return t.defined(function(n){return null!==r(n)}).x(function(t){return e(n(t),void 0===c?c:c(t))}).y(function(n){return a(r(n))})},r.d3=function(){return t},r},pathArea:function(){var n=t().curve(e);function r(t){return n(t)}return r.init=function(t,e,r,a,c){return n.defined(function(n){return null!==r(n)}).x(function(n){return e(t(n))}).y0(function(n){return a(c)}).y1(function(n){return a(r(n))})},r.d3=function(){return n},r},barWidth:u,scaledStrokeWidth:function(n,t,e){return t=t||1,e=e||1,function(){return Math.min(t,u(n)/e)+"px"}},joinPath:function(n){return function(t){return i(t.map(n())," ")}},interaction:{mousedispatch:function(n){return function(t){return t.on("mouseenter",function(t){r(this.parentNode).classed("mouseover",!0),n.call("mouseenter",this,t)}).on("mouseleave",function(t){var e=r(this.parentNode);e.classed("dragging")||(e.classed("mouseover",!1),n.call("mouseout",this,t))}).on("mousemove",function(t){n.call("mousemove",this,t)})}},dragStartEndDispatch:function(n,t){return n.on("start",function(n){r(this.parentNode.parentNode).classed("dragging",!0),t.call("dragstart",this,n)}).on("end",function(n){r(this.parentNode.parentNode).classed("dragging",!1),t.call("dragend",this,n)})}},plotComposer:function(){var n,t,e=a(),c=[],o=function(n){return n.scale()};function u(n){e.mapper(function(){return c.map(function(){return[]})})(n).selection.each(function(n,t){c[t](r(this))}),u.refresh(n)}return u.refresh=function(a){e.select(a).data(function(e){var r=t(e);if(null==r)return c.map(function(){return[]});var a=n(r);return c.map(function(t){return[{value:o(t)===n?r:o(t).invert(a)}]})}).each(function(n,t){c[t](r(this))})},u.plots=function(n){return arguments.length?(c=n,u):c},u.scale=function(t){return arguments.length?(n=t,u):n},u.accessor=function(n){return arguments.length?(t=n,u):t},u.scope=function(n){return arguments.length?(e.scope(n),u):e.scope()},u.plotScale=function(n){return arguments.length?(o=n,u):o},u}}},en=function(n,t,e,r,a){return function(){var r,c={},o=n(t()),u=14,i=50,s=[0,0],l="bottom";function d(n){var t=c.dataSelector.mapper(function(n,t){return function(e){var r=t.range(),a=r[0],c=r[r.length-1];return r=a<c?[a,c]:[c,a],e.filter(function(e){if(null===n(e)||void 0===n(e))return!1;var a=t(n(e));return null!==a&&!isNaN(a)&&r[0]<=a&&a<=r[1]})}}(c.accessor,o.scale()))(n);t.entry.append("path"),t.entry.append("text"),d.refresh(n)}return d.refresh=function(n){var t=r||(o.tickFormat()?o.tickFormat():o.scale().tickFormat());!function(n,t,e,r,a,c,o,u,i){var s="left"===r||"top"===r?-1:1;n.attr("transform","translate("+i[0]+","+i[1]+")"),n.select("path").attr("d",function(n,t,e,r,a,c,o){return function(u){var i=t.scale(),s=i(n(u)),l=c;switch(e){case"left":case"right":var d=0;return r/2<c?l=r/2:d=r/2-c,"M 0 "+s+" l "+o*Math.max(t.tickSizeInner(),1)+" "+-l+" l 0 "+-d+" l "+o*a+" 0 l 0 "+r+" l "+o*-a+" 0 l 0 "+-d;case"top":case"bottom":var f=0;return a/2<c?l=a/2:f=a/2-c,"M "+s+" 0 l "+-l+" "+o*Math.max(t.tickSizeInner(),1)+" l "+-f+" 0 l 0 "+o*r+" l "+a+" 0 l 0 "+o*-r+" l "+-f+" 0";default:throw"Unsupported orient value: axisannotation.orient("+e+"). Set to one of: 'top', 'bottom', 'left', 'right'"}}}(t,e,r,c,o,u,s)),n.select("text").text(function(n,t){return function(e){return t(n(e))}}(t,a)).call(rn,t,e,r,s)}(c.dataSelector.select(n),c.accessor,o,l,t,u,i,4,s)},d.axis=function(n){return arguments.length?(o=n,d):o},d.orient=function(n){return arguments.length?(l=n,d):l},d.format=function(n){return arguments.length?(r=n,d):r},d.height=function(n){return arguments.length?(u=n,d):u},d.width=function(n){return arguments.length?(i=n,d):i},d.translate=function(n){return arguments.length?(s=n,d):s},a(d,c).accessor(e()).dataSelector(),d}};function rn(n,t,e,r,a){var c=e.scale();switch(r){case"left":case"right":n.attr("x",a*(Math.max(e.tickSizeInner(),0)+e.tickPadding())).attr("y",an(t,c)).attr("dy",".32em").style("text-anchor",a<0?"end":"start");break;case"top":case"bottom":default:n.attr("x",an(t,c)).attr("y",a*(Math.max(e.tickSizeInner(),0)+e.tickPadding())).attr("dy",a<0?"0em":".72em").style("text-anchor","middle")}}function an(n,t){return function(e){return t(n(e))}}const cn=function(n,t,e,r){return r=r||!1,function(){var a={},c=t.pathLine();function o(n){var t=a.dataSelector(n);t.entry.append("path").attr("class","line"),r&&t.selection.append("path").attr("class","zero"),o.refresh(n)}function u(){c.init(a.accessor.d,a.xScale,a.accessor,a.yScale)}return o.refresh=function(n){!function(n,t,e,r,a,c,o){n.select("path.line").attr("d",c),o&&n.select("path.zero").attr("d",a.horizontalPathLine(t.d,e,t.z,r))}(a.dataSelector.select(n),a.accessor,a.xScale,a.yScale,t,c,r)},e(o,a).plot(n(),u).dataSelector(e.dataMapper.array),u(),o}};const on=function(n,t,e){return function(){var r={},a=t.pathLine(),c=t.pathLine(),o=t.pathLine();function u(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","adx"),t.entry.append("path").attr("class","plusDi"),t.entry.append("path").attr("class","minusDi"),u.refresh(n)}function i(){a.init(r.accessor.d,r.xScale,r.accessor.adx,r.yScale),c.init(r.accessor.d,r.xScale,r.accessor.plusDi,r.yScale),o.init(r.accessor.d,r.xScale,r.accessor.minusDi,r.yScale)}return u.refresh=function(n){!function(n,t,e,r){n.select("path.adx").attr("d",t),n.select("path.plusDi").attr("d",e),n.select("path.minusDi").attr("d",r)}(r.dataSelector.select(n),a,c,o)},e(u,r).plot(n(),i).dataSelector(e.dataMapper.array),i(),u}};const un=function(n,t,e){return function(){var r={},a=t.pathLine(),c=t.pathArea(),o=t.pathLine(),u=t.pathLine(),i=t.pathLine();function s(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","overbought"),t.entry.append("path").attr("class","oversold"),t.entry.append("path").attr("class","aroon oscillator"),t.entry.append("path").attr("class","aroon oscillatorArea"),t.entry.append("path").attr("class","aroon middle"),t.entry.append("path").attr("class","aroon up"),t.entry.append("path").attr("class","aroon down"),s.refresh(n)}function l(){a.init(r.accessor.d,r.xScale,r.accessor.oscillator,r.yScale),c.init(r.accessor.d,r.xScale,r.accessor.oscillator,r.yScale,0),o.init(r.accessor.d,r.xScale,r.accessor.m,r.yScale),u.init(r.accessor.d,r.xScale,r.accessor.up,r.yScale),i.init(r.accessor.d,r.xScale,r.accessor.down,r.yScale)}return s.refresh=function(n){!function(n,t,e,r,a,c,o,u,i,s){n.select("path.overbought").attr("d",a.horizontalPathLine(t.d,e,t.ob,r)),n.select("path.oversold").attr("d",a.horizontalPathLine(t.d,e,t.os,r)),n.select("path.aroon.oscillator").attr("d",c),n.select("path.aroon.oscillatorArea").attr("d",o),n.select("path.aroon.middle").attr("d",u),n.select("path.aroon.up").attr("d",i),n.select("path.aroon.down").attr("d",s)}(r.dataSelector.select(n),r.accessor,r.xScale,r.yScale,t,a,c,o,u,i)},e(s,r).plot(n(),l).dataSelector(e.dataMapper.array),l(),s}};const sn=function(n,t,e){return function(){var r={},a=t.pathLine(),c=t.pathLine();function o(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","up"),t.entry.append("path").attr("class","down"),o.refresh(n)}function u(){a.init(r.accessor.d,r.xScale,r.accessor.up,r.yScale),c.init(r.accessor.d,r.xScale,r.accessor.dn,r.yScale)}return o.refresh=function(n){!function(n,t,e){n.select("path.up").attr("d",t),n.select("path.down").attr("d",e)}(r.dataSelector.select(n),a,c)},e(o,r).plot(n(),u).dataSelector(e.dataMapper.array),u(),o}};const ln=function(n,t,e){return function(){var r={},a=t.pathLine(),c=t.pathLine(),o=t.pathLine();function u(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","upper"),t.entry.append("path").attr("class","middle"),t.entry.append("path").attr("class","lower"),u.refresh(n)}function i(){a.init(r.accessor.d,r.xScale,r.accessor.upper,r.yScale),c.init(r.accessor.d,r.xScale,r.accessor.middle,r.yScale),o.init(r.accessor.d,r.xScale,r.accessor.lower,r.yScale)}return u.refresh=function(n){!function(n,t,e,r){n.select("path.upper").attr("d",t),n.select("path.middle").attr("d",e),n.select("path.lower").attr("d",r)}(r.dataSelector.select(n),a,c,o)},e(u,r).plot(n(),i).dataSelector(e.dataMapper.array),i(),u}};const dn=function(n,t,e,r,a,c,o){return function(){var n,t,u,i,s={},l=r("enter","out","move"),d=c.plotComposer().scope("composed-annotation").plotScale(function(n){return n.axis().scale()}),f=c.plotComposer().scope("composed-annotation").plotScale(function(n){return n.axis().scale()});function p(n){var t=s.dataSelector(n);t.entry.append("path").attr("class","horizontal wire"),t.entry.append("path").attr("class","vertical wire"),t.entry.append("g").attr("class","axisannotation x").call(d),t.entry.append("g").attr("class","axisannotation y").call(f),n.selectAll("rect").data([void 0]).enter().append("rect").style("fill","none").style("pointer-events","all"),p.refresh(n)}function h(e,r,a,c,o){var u=e.node().__coord__;if(void 0!==u){var i=e.datum(),p=s.xScale.invert(u[0]),h=s.yScale.invert(u[1]),v=null!==p&&null!==h&&(s.accessor.xv(i)!==p||s.accessor.yv(i)!==h);s.accessor.xv(i,p),s.accessor.yv(i,h),v&&l.call("move",e.node(),i)}r.attr("d",n),a.attr("d",t),c.call(d.refresh),o.call(f.refresh),e.attr("display",S)}function v(){return d.accessor(s.accessor.xv).scale(s.xScale),f.accessor(s.accessor.yv).scale(s.yScale),p}function m(n){return n=n||{},s.accessor.xv(n,null),s.accessor.yv(n,null),n}function g(n){return void 0===n||null===s.accessor.xv(n)||null===s.accessor.yv(n)}function S(n){return g(n)?"none":null}return p.refresh=function(r){var a,c=s.xScale.range(),o=s.yScale.range(),d=s.dataSelector.select(r),f=d.select("path.vertical"),p=d.select("path.horizontal"),v=d.select("g.axisannotation.x"),g=d.select("g.axisannotation.y");a=u||s.yScale.range(),n=function(n){if(null===s.accessor.xv(n))return null;var t=s.xScale(s.accessor.xv(n)),e=s.xScale.range();return t<Math.min(e[0],e[e.length-1])||t>Math.max(e[0],e[e.length-1])?null:"M "+t+" "+a[0]+" L "+t+" "+a[a.length-1]},t=function(){var n=i||s.xScale.range();return function(t){if(null===s.accessor.yv(t))return null;var e=s.yScale(s.accessor.yv(t));return isNaN(e)?null:"M "+n[0]+" "+e+" L "+n[n.length-1]+" "+e}}(),r.selectAll("rect").attr("x",Math.min.apply(null,c)).attr("y",Math.min.apply(null,o)).attr("height",Math.abs(o[o.length-1]-o[0])).attr("width",Math.abs(c[c.length-1]-c[0])).on("mouseenter",function(){l.call("enter",this)}).on("mouseout",function(){l.call("out",this),delete d.node().__coord__,m(d.datum()),h(d,f,p,v,g)}).on("mousemove",function(n,t,r,a,c){return function(){n.node().__coord__=e(this),h(n,t,r,a,c)}}(d,f,p,v,g)),h(d,f,p,v,g)},p.xAnnotation=function(n){return arguments.length?(d.plots(n instanceof Array?n:[n]),v()):d.plots()},p.yAnnotation=function(n){return arguments.length?(f.plots(n instanceof Array?n:[n]),v()):f.plots()},p.verticalWireRange=function(n){return arguments.length?(u=n,v()):u},p.horizontalWireRange=function(n){return arguments.length?(i=n,v()):i},o(p,s).plot(a(),v).dataSelector(function(n){return g(n)?[m()]:[n]}).on(l),s.dataSelector.scope("crosshair"),v()}},fn=function(n,t,e,r,a){return function(){var c={},o=n().curve(t).defined(function(n){return null!==c.accessor.sb(n)}).x(function(n){return c.xScale(c.accessor.d(n),c.accessor.pks(n))}).y0(function(n){return c.yScale(c.accessor.sb(n))}),u=n().curve(t).defined(function(n){return null!==c.accessor.sa(n)&&null!==c.accessor.sb(n)}).x(function(n){return c.xScale(c.accessor.d(n),c.accessor.pks(n))}).y0(function(n){return c.yScale(c.accessor.sa(n))}).y1(function(n){return c.yScale(c.accessor.sb(n))}),i=r.pathLine(),s=r.pathLine(),l=r.pathLine(),d=r.pathLine(),f=r.pathLine();function p(n){var t=c.dataSelector(n),e="kumoclipup-"+pn(),r="kumoclipdown-"+pn();t.entry.append("clipPath").attr("id",r).attr("class","kumoclipdown").append("path"),t.entry.append("clipPath").attr("id",e).attr("class","kumoclipup").append("path"),t.entry.append("path").attr("class","kumo down").attr("clip-path","url(#"+r+")"),t.entry.append("path").attr("class","kumo up").attr("clip-path","url(#"+e+")"),t.entry.append("path").attr("class","senkouspanb"),t.entry.append("path").attr("class","senkouspana"),t.entry.append("path").attr("class","chikouspan"),t.entry.append("path").attr("class","kijunsen"),t.entry.append("path").attr("class","tenkansen"),p.refresh(n)}function h(){var n;i.init(c.accessor.d,c.xScale,c.accessor.sa,c.yScale,c.accessor.pks),s.init(c.accessor.d,c.xScale,c.accessor.sb,c.yScale,c.accessor.pks),l.init(c.accessor.d,c.xScale,c.accessor.c,c.yScale,(n=c.accessor.pks,function(t){return-n(t)})),d.init(c.accessor.d,c.xScale,c.accessor.ts,c.yScale),f.init(c.accessor.d,c.xScale,c.accessor.ks,c.yScale)}return p.refresh=function(n){var t,e;t=c.dataSelector.select(n),e=c.yScale,t.select(".kumoclipdown path").attr("d",o.y1(e.range()[0])),t.select(".kumoclipup path").attr("d",o.y1(e.range()[1])),t.select("path.kumo.down").attr("d",u),t.select("path.kumo.up").attr("d",u),t.select("path.senkouspanb").attr("d",s),t.select("path.senkouspana").attr("d",i),t.select("path.chikouspan").attr("d",l),t.select("path.kijunsen").attr("d",f),t.select("path.tenkansen").attr("d",d)},a(p,c).plot(e(),h).dataSelector(a.dataMapper.array),h(),p}};function pn(){return Math.random().toString(36).substr(2,9)}const hn=function(n,t,e){return function(){var r,a={},c=t.pathLine(),o=t.pathLine();function u(n){var t=a.dataSelector(n);t.selection.append("path").attr("class","difference"),t.selection.append("path").attr("class","zero"),t.selection.append("path").attr("class","macd"),t.selection.append("path").attr("class","signal"),u.refresh(n)}function i(){r=t.joinPath(s),c.init(a.accessor.d,a.xScale,a.accessor.m,a.yScale),o.init(a.accessor.d,a.xScale,a.accessor.s,a.yScale)}function s(){var n=a.accessor,t=a.xScale,e=a.yScale,r=a.width(t);return function(a){var c=e(0),o=e(n.dif(a))-c;return"M "+(t(n.d(a))-r/2)+" "+c+" l 0 "+o+" l "+r+" 0 l 0 "+-o}}return u.refresh=function(n){!function(n,t,e,r,a,c,o,u){n.select("path.difference").attr("d",c),n.select("path.zero").attr("d",a.horizontalPathLine(t.d,e,t.z,r)),n.select("path.macd").attr("d",o),n.select("path.signal").attr("d",u)}(a.dataSelector.select(n),a.accessor,a.xScale,a.yScale,t,r,c,o)},e(u,a).plot(n(),i).width(i).dataSelector(e.dataMapper.array),i(),u}};const vn=function(n,t,e,r,a){return function(){var n,t,c={};function o(n){r.appendPathsUpDownEqual(c.dataSelector(n).selection,c.accessor,"ohlc"),o.refresh(n)}function u(){n=r.joinPath(i),t=r.scaledStrokeWidth(c.xScale,1,2)}function i(){var n=c.accessor,t=c.xScale,e=c.yScale,r=c.width(t);return function(a){var c=e(n.o(a)),o=e(n.c(a)),u=t(n.d(a));return"M "+(u-r/2)+" "+c+" l "+r/2+" 0 M "+u+" "+e(n.h(a))+" L "+u+" "+e(n.l(a))+" M "+u+" "+o+" l "+r/2+" 0"}}return o.refresh=function(e){e.selectAll("path.ohlc").attr("d",n).style("stroke-width",t)},a(o,c).plot(e(),u).width(u).dataSelector(a.dataMapper.array),u(),o}},mn=function(n,t,e){return function(){var r={},a=t.pathLine();function c(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","overbought"),t.entry.append("path").attr("class","middle"),t.entry.append("path").attr("class","oversold"),t.entry.append("path").attr("class","rsi"),c.refresh(n)}function o(){a.init(r.accessor.d,r.xScale,r.accessor.r,r.yScale)}return c.refresh=function(n){!function(n,t,e,r,a,c){n.select("path.overbought").attr("d",a.horizontalPathLine(t.d,e,t.ob,r)),n.select("path.middle").attr("d",a.horizontalPathLine(t.d,e,t.m,r)),n.select("path.oversold").attr("d",a.horizontalPathLine(t.d,e,t.os,r)),n.select("path.rsi").attr("d",c)}(r.dataSelector.select(n),r.accessor,r.xScale,r.yScale,t,a)},e(c,r).plot(n(),o).dataSelector(e.dataMapper.array),o(),c}};const gn=function(n,t,e){return function(){var r={},a=t.pathLine(),c=t.pathLine();function o(n){var t=r.dataSelector(n);t.entry.append("path").attr("class","overbought"),t.entry.append("path").attr("class","oversold"),t.entry.append("path").attr("class","stochastic k"),t.entry.append("path").attr("class","stochastic d"),o.refresh(n)}function u(){a.init(r.accessor.d,r.xScale,r.accessor.k,r.yScale),c.init(r.accessor.d,r.xScale,r.accessor.sd,r.yScale)}return o.refresh=function(n){!function(n,t,e,r,a,c,o){n.select("path.overbought").attr("d",a.horizontalPathLine(t.d,e,t.ob,r)),n.select("path.oversold").attr("d",a.horizontalPathLine(t.d,e,t.os,r)),n.select("path.stochastic.k").attr("d",c),n.select("path.stochastic.d").attr("d",o)}(r.dataSelector.select(n),r.accessor,r.xScale,r.yScale,t,a,c)},e(o,r).plot(n(),u).dataSelector(e.dataMapper.array),u(),o}};const Sn=function(n,t,e,r,a,c,o){return function(){var u={},i=r("mouseenter","mouseout","mousemove","drag","dragstart","dragend"),s=c.plotComposer().scope("composed-annotation").plotScale(function(n){return n.axis().scale()});function l(n){var t=u.dataSelector(n);t.entry.append("g").attr("class","supstance").append("path"),t.entry.append("g").attr("class","axisannotation y").call(s),t.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(c.interaction.mousedispatch(i)).append("path").style("stroke-width","16px"),l.refresh(n)}function d(){return s.accessor(u.accessor.v).scale(u.yScale),l}return l.refresh=function(n){yn(u.dataSelector.select(n),u.accessor,u.xScale,u.yScale,s)},l.drag=function(r){r.selectAll(".interaction path").call(function(r,a,o,u,i){var s=n().subject(function(n){return{x:0,y:u(a(n))}}).on("drag",function(n){var c=u.invert(t().y),s=e(this.parentNode.parentNode);a.v(n,c),yn(s,a,o,u,i),r.call("drag",this,n)});return c.interaction.dragStartEndDispatch(s,r)}(i,u.accessor,u.xScale,u.yScale,s))},l.annotation=function(n){return arguments.length?(s.plots(n instanceof Array?n:[n]),l):s.plots()},o(l,u).dataSelector(o.dataMapper.unity).plot(a(),d).on(i),u.dataSelector.scope("supstance"),d()}};function yn(n,t,e,r,a){n.select(".supstance path").attr("d",xn(t,e,r)),n.select(".interaction path").attr("d",xn(t,e,r)),n.select(".axisannotation.y").call(a.refresh)}function xn(n,t,e){return function(r){var a;return!function(n){return void 0!==n.s&&void 0!==n.e}(n)?a=t.range():((a=[n.s(r),n.e(r)])[0]=void 0!==a[0]?t(a[0]):t.range()[0],a[1]=void 0!==a[1]?t(a[1]):t.range()[1]),"M "+a[0]+" "+e(n(r))+" L "+a[a.length-1]+" "+e(n(r))}}const kn=function(n,t,e,r,a){return function(){var n,t,c={};function o(n){c.dataSelector(n).entry.append("path").attr("class","tick"),o.refresh(n)}function u(){n=r.joinPath(i),t=r.scaledStrokeWidth(c.xScale,1,2)}function i(){var n=c.accessor,t=c.xScale,e=c.yScale,r=c.width(t);return function(a){var c=e(n.h(a)),o=e(n.l(a)),u=t(n.d(a)),i=u-r/2;return"M "+i+" "+c+" l "+r+" 0 M "+u+" "+c+" L "+u+" "+o+" M "+i+" "+o+" l "+r+" 0"}}return o.refresh=function(e){c.dataSelector.select(e).select("path.tick").attr("d",n).style("stroke-width",t)},a(o,c).plot(e(),u).width(u).dataSelector(a.dataMapper.array),u(),o}},wn=function(n,t,e,r,a,c,o,u){return function(){var i,s={},l=r("mouseenter","mouseout"),d=function(n){return s.yScale(s.accessor.p(n))},f=u().orient(function(n){return"buy"===s.accessor.t(n)?"up":"down"});function p(t){var r=s.dataSelector(t),a=t.datum().map(function(n){return s.accessor.t(n)}).reduce(function(n,t){return void 0===n[t]&&(n[t]=function(n){return t===s.accessor.t(n)}),n},{});c.appendPathsGroupBy(r.selection,s.accessor,"tradearrow",a),r.entry.append("path").attr("class","highlight").style("pointer-events","none"),r.selection.selectAll("path.tradearrow").on("mouseenter",function(t){var r=v(t,e(this)[0]);n(this.parentNode).select("path.highlight").datum(r.d).attr("d",f).call(Mn,a),l.call("mouseenter",this,r.d,r.i)}).on("mouseout",function(t){n(this.parentNode).selectAll("path.highlight").datum([]).attr("d",null).attr("class","highlight");var r=v(t,e(this)[0]);l.call("mouseout",this,r.d,r.i)}),p.refresh(t)}function h(){return f.x(function(n){return s.xScale(s.accessor.d(n))}).y(d),i=c.joinPath(function(){return f}),p}function v(n,t){return n.map(function(n,t){return{d:n,i:t,x:s.xScale(s.accessor.d(n))}}).reduce(function(n,e){return Math.abs(n.x-t)<Math.abs(e.x-t)?n:e})}return p.refresh=function(n){n.selectAll("path.tradearrow").attr("d",i)},p.orient=function(n){return arguments.length?(f.orient(n),h()):f.orient()},p.y=function(n){return arguments.length?(d=t(n),h()):d},p.arrow=function(){return f},o(p,s).plot(a(),h).on(l).dataSelector(o.dataMapper.array),h(),p}};function Mn(n,t){Object.keys(t).forEach(function(e){n.classed(e,t[e])})}const bn=function(n,t,e,r,a,c,o){function u(r,a,o,u,s,l){var d=n();return d.subject(function(n){return{x:u(o(n)),y:l(s(n))}}).on("drag",function(n){i(o,u,t().x,s,l,t().y,n),Ln(e(this.parentNode.parentNode.parentNode),a,u,l),r.call("drag",this,n)}),c.interaction.dragStartEndDispatch(d,r)}function i(n,t,e,r,a,c,o){var u=t.invert(e);null!=u&&n(o,u),r(o,a.invert(c))}return function(){var s={},l=r("mouseenter","mouseout","mousemove","drag","dragstart","dragend");function d(n){var t=s.dataSelector(n),e=t.entry.append("g").attr("class","trendline");e.append("path").attr("class","body"),e.append("circle").attr("class","start").attr("r",1),e.append("circle").attr("class","end").attr("r",1);var r=t.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(c.interaction.mousedispatch(l));r.append("path").attr("class","body").style("stroke-width","16px"),r.append("circle").attr("class","start").attr("r",8),r.append("circle").attr("class","end").attr("r",8),d.refresh(n)}return d.refresh=function(n){Ln(s.dataSelector.select(n),s.accessor,s.xScale,s.yScale)},d.drag=function(r){r.selectAll(".interaction circle.start").call(u(l,s.accessor,s.accessor.sd,s.xScale,s.accessor.sv,s.yScale)),r.selectAll(".interaction circle.end").call(u(l,s.accessor,s.accessor.ed,s.xScale,s.accessor.ev,s.yScale)),r.selectAll(".interaction path.body").call(function(r,a,o,u){var s={},l=n();return l.subject(function(n){return s.start={date:o(a.sd(n)),value:u(a.sv(n))},s.end={date:o(a.ed(n)),value:u(a.ev(n))},{x:0,y:0}}).on("drag",function(n){i(a.sd,o,t().x+s.start.date,a.sv,u,t().y+s.start.value,n),i(a.ed,o,t().x+s.end.date,a.ev,u,t().y+s.end.value,n),Ln(e(this.parentNode.parentNode.parentNode),a,o,u),r.call("drag",this,n)}),c.interaction.dragStartEndDispatch(l,r)}(l,s.accessor,s.xScale,s.yScale))},o(d,s).dataSelector(o.dataMapper.unity).plot(a()).on(l),d}};function Ln(n,t,e,r){n.selectAll("path.body").attr("d",function(n,t,e){return function(r){return"M "+t(n.sd(r))+" "+e(n.sv(r))+" L "+t(n.ed(r))+" "+e(n.ev(r))}}(t,e,r)),n.selectAll("circle.start").attr("cx",Dn(t.sd,e)).attr("cy",zn(t.sv,r)),n.selectAll("circle.end").attr("cx",Dn(t.ed,e)).attr("cy",zn(t.ev,r))}function Dn(n,t){return function(e){return t(n(e))}}function zn(n,t){return function(e){return t(n(e))}}const An=function(n,t,e){return function(){var r={},a=t.pathLine();function c(n){r.dataSelector(n).entry.append("path").attr("class","williams up"),c.refresh(n)}function o(){a.init(r.accessor.d,r.xScale,r.accessor.w,r.yScale)}return c.refresh=function(n){r.dataSelector.select(n).select("path.williams.up").attr("d",a)},e(c,r).plot(n(),o).dataSelector(e.dataMapper.array),o(),c}},Pn=function(n,t,e){return function(){var r,a={};function c(n){var e=a.dataSelector(n);u()?t.appendPathsUpDownEqual(e.selection,a.accessor,"volume"):e.entry.append("path").attr("class","volume"),c.refresh(n)}function o(){r=t.joinPath(i)}function u(){return a.accessor.o&&a.accessor.c}function i(){var n=a.accessor,t=a.xScale,e=a.yScale,r=a.width(t);return function(a){var c=n.v(a);if(isNaN(c))return null;var o=e(0),u=e(c)-o;return"M "+(t(n.d(a))-r/2)+" "+o+" l 0 "+u+" l "+r+" 0 l 0 "+-u}}return c.refresh=function(n){u()?n.selectAll("path.volume").attr("d",r):a.dataSelector.select(n).select("path.volume").attr("d",r)},e(c,a).plot(n(),o).width(o).dataSelector(e.dataMapper.array),o(),c}};function jn(){return t.event}var Fn={accessor:y(),indicator:function(n){var t=function(n,t){var e={period:function(r){return t.period=r,n.period=function(e){return arguments.length?(t.period=+e,n):t.period},n.preroll=function(){return t.period},e},accessor:function(r){return t.accessor=r,n.accessor=function(e){return arguments.length?(t.accessor=e,n):t.accessor},e},preroll:function(t){return n.preroll=t,e}};return n.preroll=function(){return 0},e},e=y(),r=x(t,e.ohlc,G),a=function(n,t){return function(){var e,r,a,c={};function o(n){return o.init(),n.map(u).filter(function(n){return null!==n.value})}function u(n,t){var e=o.average(c.accessor(n));return t+1<c.period&&(e=null),{date:c.accessor.d(n),value:e}}return o.init=function(){return a=0,e=[],r=0,o},o.average=function(n){return a+=n,e.length+1<c.period?(e.push(n),a/++r):(e.length<c.period&&(e.push(n),a+=n),a-=e[r],e[r]=n,++r===c.period&&(r=0),a/c.period)},n(o,c).accessor(t()).period(10),o}}(t,e.ohlc),c=function(n,t,e){return function(){var r={},a=e(),c=null,o=0,u=0;function i(n){return i.init(),n.map(function(n,t){var e=i.atr(n);return t>=r.period?k(r.accessor.d(n),e):k(r.accessor.d(n))}).filter(function(n){return null!==n.value})}return i.init=function(){return a.accessor(i.accessor()).period(r.period).init(),c=null,o=0,u=0,i},i.atr=function(n){var t=null===c?r.accessor.h(n)-r.accessor.l(n):Math.max(r.accessor.h(n)-r.accessor.l(n),Math.abs(r.accessor.h(n)-r.accessor.c(c)),Math.abs(r.accessor.l(n)-r.accessor.c(c)));return c=n,o=u++<=r.period?a.average(t):(o*(r.period-1)+t)/r.period},n(i,r).accessor(t()).period(14),i}}(t,e.ohlc,a),o=M().circularbuffer;return{atr:c,atrtrailingstop:A(t,e.ohlc,c),ema:r,heikinashi:P(t,e.ohlc,n.min,n.max),ichimoku:j(t,e.ohlc),macd:B(t,e.ohlc,r),rsi:I(t,e.ohlc,r),sma:a,wilderma:x(t,e.ohlc,R),aroon:E(t,e.ohlc),roc:D(o,t,e.ohlc,r,1),sroc:D(o,t,e.ohlc,r,13),stochastic:H(t,e.ohlc),williams:W(t,e.ohlc),adx:_(n.max,t,e.ohlc,r),bollinger:K(t,e.ohlc,a),vwap:z(t,e.ohlc)}}(t),plot:function(n){var t=Q(n),e=y(),r=tn(n.line,n.area,n.curveMonotoneX,n.select),a=M().functor,c=function(n,t,e,r,a){var c=function(c,o){var u={dataSelector:function(n,t){return o.dataSelector=r(n).key(t),u},xScale:function(n){return o.xScale=e(),c.xScale=function(t){return arguments.length?(o.xScale=t,n&&n(),c):o.xScale},u},yScale:function(t){return o.yScale=n(),c.yScale=function(n){return arguments.length?(o.yScale=n,t&&t(),c):o.yScale},u},accessor:function(n,t){return o.accessor=n,c.accessor=function(n){return arguments.length?(o.accessor=n,t&&t(),c):o.accessor},u},width:function(n){return o.width=a,c.width=function(e){return arguments.length?(o.width=t(e),n&&n(),c):o.width},u},on:function(n,t){return c.on=function(e,r){return n.on(e,r),t&&t(),c},u},plot:function(n,t){return u.xScale(t).yScale(t).accessor(n,t)}};return u};return c.dataMapper=r.mapper,c}(n.scaleLinear,a,t.financetime,r.dataSelector,r.barWidth),o=function(n,t,e,r,a){return function(){var n,t,c,o={};function u(n){var t=o.dataSelector(n);r.appendPathsUpDownEqual(t.selection,o.accessor,["candle","body"]),r.appendPathsUpDownEqual(t.selection,o.accessor,["candle","wick"]),u.refresh(n)}function i(){n=r.joinPath(s),t=r.joinPath(l),c=r.scaledStrokeWidth(o.xScale,1,4)}function s(){var n=o.accessor,t=o.xScale,e=o.yScale,r=o.width(t);return function(a){var c=e(n.o(a)),o=e(n.c(a)),u=t(n.d(a))-r/2,i="M "+u+" "+c+" l "+r+" 0";return c!=o&&(i+=" L "+(u+r)+" "+o+" l "+-r+" 0 L "+u+" "+c),i}}function l(){var n=o.accessor,t=o.xScale,e=o.yScale,r=o.width(t);return function(a){var c=e(n.o(a)),o=e(n.c(a)),u=t(n.d(a)),i=u-r/2,s="M "+u+" "+e(n.h(a))+" L "+u+" "+Math.min(c,o);return c==o&&(s+=" M "+i+" "+c+" l "+r+" 0"),s+" M "+u+" "+Math.max(c,o)+" L "+u+" "+e(n.l(a))}}return u.refresh=function(e){e.selectAll("path.candle.body").attr("d",n),e.selectAll("path.candle.wick").attr("d",t).style("stroke-width",c)},a(u,o).plot(e(),i).width(i).dataSelector(a.dataMapper.array),i(),u}}(n.scaleLinear,n.extent,e.ohlc,r,c),u=en(n.axisTop,n.scaleLinear,e.value,0,c),i=V();return{adx:on(e.adx,r,c),aroon:un(e.aroon,r,c),atr:cn(e.value,r,c),atrtrailingstop:sn(e.atrtrailingstop,r,c),axisannotation:u,bollinger:ln(e.bollinger,r,c),candlestick:o,close:cn(e.ohlc,r,c),crosshair:dn(n.select,0,n.mouse,n.dispatch,e.crosshair,r,c),ema:cn(e.value,r,c),heikinashi:o,ichimoku:fn(n.area,n.curveMonotoneX,e.ichimoku,r,c),macd:hn(e.macd,r,c),momentum:cn(e.value,r,c,!0),moneyflow:cn(e.value,r,c,!0),ohlc:vn(n.scaleLinear,n.extent,e.ohlc,r,c),roc:cn(e.value,r,c,!0),rsi:mn(e.rsi,r,c),sma:cn(e.value,r,c),sroc:cn(e.value,r,c,!0),stochastic:gn(e.stochastic,r,c),supstance:Sn(n.drag,jn,n.select,n.dispatch,e.supstance,r,c),tick:kn(n.scaleLinear,n.extent,e.tick,r,c),tradearrow:wn(n.select,a,n.mouse,n.dispatch,e.trade,r,c,i.arrow),trendline:bn(n.drag,jn,n.select,n.dispatch,e.trendline,r,c),volume:Pn(e.volume,r,c),vwap:cn(e.value,r,c),wilderma:cn(e.value,r,c),williams:An(e.williams,r,c)}}(t),scale:Q(t),svg:V()};n.techan=Fn,Object.defineProperty(n,"__esModule",{value:!0})});
